<html>
<head>
<!-- <link href="Schema.css" rel="stylesheet" type="text/css" /> -->
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	$("#loadGoodApp").click(function(){
	//$("#editorCanvas").append("Hello Two").css("color","red");
	$.ajax({
		type: "GET",
		url: "GoodJava.xml",
		cache: false,
		success: readXML/* function(xml){
			$("#editorCanvas").append(xml);
		}*/,
		error: function(httpReq, textStatus, errorThrown)
		{
			alert(textStatus);
			alert(errorThrown);
		}
	});
	//return false;
	});
});


function readXML(xml)
{
	state.clearActiveTags();
	$(xml).find("dimension").each(function(){
		var dim = new Dimension($(this).children("name").text(), $(this).children("default").text());
		$(this).find("tag").each(function(){
			dim.addTag($(this).text());
		});
		state.addActiveTag($(this).children("default").text());
		state.addDimension(dim);
	});
	loadState(xml);
	$("#editorCanvas").append(xml);
	$("#editorCanvas").children("document").children("dimensions").hide();
	$("#editorCanvas").children("document").children("part").find("choice").each(function(){
		$(this).children("alternatives").children("alternative").each(function(){
			if ($.inArray($(this).children("label").children("tag").text(),state.ActiveTags())==-1)
			{
				$(this).hide();
			}
		});
	});
};

var Dimension = function(name, defaultTag){
	this.name = name;
	this._tags = new Array();
	this.defaultTag = defaultTag;
}

Dimension.prototype.addTag = function(tag){
	this._tags.push(tag);
};

Dimension.prototype.Tags = function(){
	return this._tags;
};

var ViewerUIState = function(){
	this._dimensions = new Array();
	this._activeTags = new Array();

}

ViewerUIState.prototype.ActiveTags = function()
{
	return this._activeTags;
};

ViewerUIState.prototype._Dimensions = function()
{
	return this._dimensions;
};

ViewerUIState.prototype.addDimension = function(dim){
	this._dimensions.push(dim);
};

ViewerUIState.prototype.clearActiveTags = function(tags){
	this._activeTags = new Array();
};

ViewerUIState.prototype.addActiveTag = function(tag){
	this._activeTags.push(tag);
};

ViewerUIState.prototype.updateActiveTags = function(tags){
	this._activeTags = tags;
};


var state = new ViewerUIState();

function loadState(xml)
{
	//$(xml).children("dimensions").hide();
//	$(xml).("document > dimensions 
}

</script>
</head>
<body>
<a id="loadGoodApp" href="#">Link</a>
<div id="editorCanvas"></div>
</body>
</html>
